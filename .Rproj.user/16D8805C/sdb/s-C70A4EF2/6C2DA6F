{
    "contents" : "\n#' @title Clean X Numbers\n#' @description Useful for correcting manually entered or missing X-numbers that may be abbreviated or contain non-standard methods for handling null values such as \"No #\"\n#' @param x character vector containing X numbers\n#' @param using string indicating the name of a reference identifier to compare with. May be one of the following options: \"CASE\" or \"CII\".\n#' @param value list or character vector that contains the actual values of the known identifier.\n#' @details By default, clean_x() simply pads the string containing X numbers and ensures it meets the standard format. This is useful when correcting a small amount of X numbers, or when there is an untrustworthy reference identifier. If a clean case or CII number is available, the X numbers can be cross-referenced to a built-in table using the reference identifier. Only one reference identifier is allowed at the time of the current release.\n#' @return Character vector of standardized X numbers. By default, NA values are introduced where there appears to be non-X characters present, unless a match was found in the reference table.\n#' @seealso clean_case, clean_id, obtain_id\n#' @examples\n#' clean_x(\"X6789\") # X00006789\n#' clean_x(\"No #\") # NA\n#' clean_x(\"1234\") # X00001234\n#' clean_x(\"X00020\", using = \"CASE\", value = \"PB021665\")\n#' clean_x(\"X00020\", using = \"CII\", value = \"A07515123\")\n\n# X-Number Cleaning\n#' @export\nclean_x <- function(x, using = NULL, value = NULL) {\n\n  # Strip away all characters, even if it's something that indicates an empty value such as \"No PB #\"\n  x <- stringr::str_replace_all(x, pattern = \"[A-Za-z]\", replacement = \"\")\n\n  # Replace all whitespace\n  x <- stringr::str_replace_all(x, pattern = \" \", replacement = \"\")\n\n  # Pad each element with zeros to become 6 digits long\n  padded <- vapply(x, stringr::str_pad, FUN.VALUE = \"character\", width = 8, side = \"left\", pad = \"0\")\n\n  # Add the PB prefix to all strings\n  padded <- stringr::str_c(\"X\", padded)\n\n  # Convert the ones that originally used text to indicate null values to NA\n  padded[grep(\"X0000000\", padded)] <- NA\n\n  ## If the using argument is not null, use the reference table to verify the X numbers.\n  if (is.null(using)) {\n    # Return the cleaned up version of the character vector\n    return(padded)\n\n  } else if (!is.null(using) & is.null(value)) {\n\n    stop(\"The 'value' argument is null when 'using' argument is not null\")\n\n  } else {\n\n    verified <- obtain_id(obtain = \"X\", using = using, value = value)\n\n    return(verified)\n  }\n\n}\n\n",
    "created" : 1452184192448.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3310945218",
    "id" : "6C2DA6F",
    "lastKnownWriteTime" : 1452185357,
    "path" : "~/identifyr/R/clean_x.R",
    "project_path" : "R/clean_x.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}